# 🎭 Mock API Server 使用指南

## 📖 介绍

Mock API Server 是一个轻量级的模拟后端服务，让你无需配置真实的 Python 后端、数据库和 AI API Key，就能完整测试 ContentHub 的所有功能。

## ✨ 特性

- ✅ **完整的 API 模拟** - 所有后端接口都已实现
- ✅ **智能的 Mock 数据** - 返回真实感的测试数据
- ✅ **无需数据库** - 数据存储在内存中
- ✅ **无需 AI API Key** - 自动生成模拟的 AI 提炼结果
- ✅ **即开即用** - 一条命令启动

---

## 🚀 快速开始

### 方式 1：使用 npm 脚本（推荐）

```bash
cd contenthub
npm run mock
```

### 方式 2：直接运行

```bash
cd contenthub
node mock-server.js
```

---

## 📍 启动后

Mock 服务器会在 **http://localhost:8000** 启动

你会看到类似的输出：

```
🎉 ====================================
🚀 ContentHub Mock API Server 已启动！
🎉 ====================================
📍 地址: http://localhost:8000
📖 API文档: http://localhost:8000/

✨ 可用的 API:
   - 素材管理: /api/materials/*
   - AI提炼: /api/ai/*
   - 选题管理: /api/topics/*
   - 配置管理: /api/configs
====================================
```

---

## 🎯 完整测试流程

现在你可以打开前端测试完整流程：

### 1️⃣ 启动 Mock API Server

```bash
cd contenthub
npm run mock
```

### 2️⃣ 启动前端

```bash
cd contenthub/frontend
npm run dev
```

### 3️⃣ 访问应用

打开浏览器访问 **http://localhost:3000**

---

## 🧪 测试步骤

### Step 1: 配置（可选）

进入 **⚙️ 设置** 页面，你会看到：
- AI 模型已设置为 `gpt-3.5-turbo`
- API Key 已有一个测试值 `sk-mock-key-for-testing`
- 预设标签和提示词都已配置好

**注意：** Mock 服务器不会真实调用 AI API，所以这里的配置仅用于演示。

---

### Step 2: 添加素材

#### 方式 1：添加文本素材

1. 在首页输入测试文本（例如：）
```
今天学到了一个超级有用的技巧！
只需要三个步骤，就能让工作效率提升3倍。
第一步：明确目标
第二步：制定计划
第三步：坚持执行
真的很简单，但很少人能做到！
```

2. 选择来源平台（如：Twitter）
3. 点击 **"保存到素材库"**
4. 素材会被保存，并自动跳转到素材库

#### 方式 2：上传 PDF

1. 点击或拖拽上传 PDF 文件
2. Mock 服务器会模拟 PDF 文本提取
3. 自动生成一段测试文本

---

### Step 3: 浏览素材库

在 **📚 素材库** 页面：
- 查看所有已添加的素材
- 使用搜索和筛选功能
- 选择一个素材，点击 **"查看"** 或 **"AI 提炼"**

---

### Step 4: AI 提炼

1. 在素材详情或素材库中点击 **"AI 提炼"**
2. 选择一个提示词：
   - ✅ 提取核心观点
   - ✅ 生成短视频脚本
   - ✅ 提炼标题
3. 点击 **"开始 AI 提炼"**
4. 等待 1.5 秒（模拟 AI 处理时间）
5. 查看 Mock AI 生成的提炼结果
6. 可以编辑结果
7. 点击 **"保存为选题"**

---

### Step 5: 保存选题

1. 输入选题标题
2. 编辑选题内容（已自动填充）
3. 选择标签（多选）
4. 点击 **"💾 保存选题"**
5. 自动跳转到选题列表

---

### Step 6: 查看选题列表

在 **📝 选题列表** 页面：
- 查看所有已保存的选题
- 使用搜索功能
- 使用标签筛选
- 点击卡片查看详情

---

### Step 7: 查看选题详情

- 查看完整的选题内容
- 展开查看原始素材
- 查看统计信息（字数、压缩比）
- 点击 **"编辑"** 或 **"删除"**

---

### Step 8: 编辑选题

1. 修改标题
2. 修改内容
3. 修改标签
4. 点击 **"保存修改"**
5. 返回详情页确认

---

### Step 9: 删除选题

1. 点击 **"删除"** 按钮
2. 确认删除
3. 返回列表页

---

### Step 10: 自定义提示词

1. 进入 **⚙️ 设置** 页面
2. 找到 **💬 提示词管理** 卡片
3. 点击 **"添加提示词"**
4. 输入：
   - 名称：例如 "生成标签"
   - 描述：例如 "为内容生成相关标签"
   - 内容：例如 "根据以下内容，生成5-8个相关的标签..."
5. 点击 **"保存"**
6. 别忘了点击页面底部的 **"保存设置"**
7. 返回素材库，重新进行 AI 提炼，你会看到新的提示词选项

---

## 📊 Mock 数据说明

### AI 提炼结果

Mock 服务器会根据不同的提示词返回不同的模拟结果：

- **提取核心观点** → 返回 4 个核心观点
- **生成短视频脚本** → 返回完整的 60 秒脚本（开头/正文/结尾）
- **提炼标题** → 返回 5 个标题方案
- **自定义提示词** → 返回通用的演示文本

### 数据持久性

⚠️ **注意：** Mock 服务器的数据仅存在内存中，重启服务器后所有数据会丢失。

---

## 🛑 停止服务器

按 `Ctrl + C` 或 `Cmd + C` 停止 Mock 服务器

---

## 🔍 API 端点列表

访问 **http://localhost:8000** 查看完整的 API 文档

主要端点：

### 素材管理
- `POST /api/materials/text` - 创建文本素材
- `POST /api/materials/pdf` - 上传 PDF
- `GET /api/materials` - 获取素材列表
- `GET /api/materials/:id` - 获取素材详情

### AI 提炼
- `GET /api/prompts` - 获取提示词列表
- `POST /api/ai/refine` - AI 内容提炼

### 选题管理
- `POST /api/topics` - 创建选题
- `GET /api/topics` - 获取选题列表
- `GET /api/topics/:id` - 获取选题详情
- `PUT /api/topics/:id` - 更新选题
- `DELETE /api/topics/:id` - 删除选题

### 配置管理
- `GET /api/configs` - 获取配置
- `PUT /api/configs` - 更新配置

---

## 💡 提示

1. **测试完整流程**  
   使用 Mock 服务器可以快速验证所有功能是否正常工作

2. **无需真实 API Key**  
   不需要配置 OpenAI、Claude 或 DeepSeek 的 API Key

3. **快速迭代**  
   适合前端开发和 UI/UX 调整

4. **演示和展示**  
   可以用来演示项目功能，无需真实的后端环境

---

## 🔄 切换到真实后端

当你准备好使用真实的后端时：

1. 停止 Mock 服务器（`Ctrl + C`）
2. 启动真实的后端：
   ```bash
   cd contenthub/backend
   source venv/bin/activate
   uvicorn main:app --reload
   ```
3. 配置真实的 API Key
4. 前端会自动连接到真实的后端

---

## 📞 常见问题

**Q: Mock 服务器启动失败？**  
A: 确保端口 8000 没有被占用，或者检查是否安装了 Node.js

**Q: 前端连接不上 Mock 服务器？**  
A: 检查 `frontend/vite.config.js` 中的 proxy 配置是否指向 `http://localhost:8000`

**Q: 数据丢失了？**  
A: Mock 服务器的数据存在内存中，重启后会清空。这是正常的。

---

## 🎉 开始测试吧！

```bash
# Terminal 1: 启动 Mock API Server
cd contenthub
npm run mock

# Terminal 2: 启动前端
cd contenthub/frontend
npm run dev

# 打开浏览器
http://localhost:3000
```

**祝测试愉快！** 🚀

